# Сервис авторизации и аутентификации на FastAPI

## Описание
Сервис авторизации и аутентификации на FastAPI. Проект обеспечивает безопасный доступ к API и управление пользователями.

## Описание задания
Необходимо реализовать backend-приложение – собственную систему аутентификации и авторизации. Приложение не должно быть полностью основано на соответствующих возможностях фреймворков, идущих «из коробки».

### Основные модули системы по заданию

#### Взаимодействие с пользователем
*	Позволяет пользователям регистрироваться, входить в систему, выходить из учетной записи, обновлять свои данные и удалять аккаунт.
*	Регистрация: Ввод имени (фамилии, отчества), email, пароля, повтор пароля.
*	Обновление информации: Пользователь может редактировать свой профиль.
*	Удаление пользователя: Удаление аккаунта (мягкое) — пользователь инициирует удаление, происходит logout, пользователь больше не может залогиниться, но при этом в базе учетная запись остается со статусом is_active=False.
*	Login: пользователь входить в систему по email и паролю.
*	Logout: пользователь выходит из системы.
* После login система при последующих обращениях должна идентифицировать пользователя.

#### Система разграничения прав доступа. 
*	Вы должны продумать и в текстовом файле или в REAME.md описать схему вашей структуры управления ограничениями доступа.
*	Реализованы соответствующие таблицы в БД.
*	Таблицы заполнены тестовыми данными для минимальной отработки приложения для демонстрации работающей системы.
*	Если пользователь имеет доступ к ресурсу по вышеописанным правилам, ему выдается запрашиваемый ресурс. Если по входящему запросу не удается определить залогиненного пользователя, выдается ошибка 401. Если пользователь определен, но запрашиваемый ресурс ему не доступен 403 ошибка — Forbidden. 
*	Реализовать API с возможностью получения и изменения этих правил пользователю, имеющему роль администратора.


## Стек технологий
- Python 3.13+
- FastAPI для API
- Dishka для DI
- SQLAlchemy и asyncpg для асинхронной работы с PostgreSQL
- Alembic для миграций базы данных
- Redis для кеширования
- Taskiq для фоновых задач
- RabbitMQ для очередей

## Десклеймер
В данном проекте RabbitMQ и Taskiq не подключил из-за ныняшней ненадобности, но в будущем можно использовать их для фоновых задач и очередей.

## Настройка и запуск

### Требования
- PostgreSQL 14+
- Redis 7+
- MinIO (или совместимое S3-хранилище)

### Настройка переменных окружения
Создайте файл `.env` на основе `.env.example` и заполните переменные
В самом начале сразу создадутся пользователи:
Суперюзер:
- email: `superadmin@example.com`
- password: `superpass`

А также обычный администратор, который, допустим, не может назначать суперадмином и тп:
- email: `admin@example.com`
- password: `adminpass`


### Установка зависимостей и виртуальное окружение

Установите Poetry

```bash
pip install poetry
```

Создайте и активируйте виртуальное окружение

```bash
poetry env use python3.13
```

Установите зависимости проекта

```bash
poetry install
```

Создание новой миграции:
```bash
alembic revision --autogenerate -m "init"
```

Применение миграций:
```bash
alembic upgrade head
```

Запуск приложения

```shell
uvicorn src.main:app --host=0.0.0.0 --port=8000
```

